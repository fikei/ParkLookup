â„¹ï¸ Google Maps SDK not installed. Map features will use placeholder.
LocalZoneDataSource initialized
PersistentZoneCache initialized at: /Users/ian/Library/Developer/CoreSimulator/Devices/B9A9D495-4857-49A2-B859-36D644F0D98A/data/Containers/Data/Application/73D69EC1-20BA-4951-9E1A-98C76B8329F8/Library/Caches/ZoneData
ZoneRepository initialized
Getting zones for city: sf
Loaded 421 zones from disk cache in 490.2ms
âœ“ Returning 421 zones from cache
No active session to load
Loaded 10 sessions from history
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸš€ BUILD VERIFICATION: makeUIView called with 0 zones - DUPLICATE FIX ACTIVE
Failed to locate resource named "default.csv"
CAMetalLayer ignoring invalid setDrawableSize width=0.000000 height=0.000000
ğŸ” updateUIView called: overlaysLoaded=false, userPermitAreas=[], lastUserPermitAreas=[]
ğŸ” Visibility check: showOverlays=false, overlaysVisible=false, overlays.count=0
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸ” updateUIView called: overlaysLoaded=false, userPermitAreas=[], lastUserPermitAreas=[]
ğŸ” Visibility check: showOverlays=false, overlaysVisible=false, overlays.count=0
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
Getting zones for city: sf
Cache hit (memory) for city: sf
âœ“ Returning 421 zones from cache
âœ… Loaded 421 zones in 181.3ms: 33 RPP, 388 metered, 0 other
ğŸ“Š Spatial index: 421 bounding boxes, 98 grid cells
Returning result with primary zone: I, confidence: medium
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
Resetting GeoCodec zone allocator at address 0x600003d55950 with 374 allocations still alive
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸš€ BUILD VERIFICATION: makeUIView called with 421 zones - DUPLICATE FIX ACTIVE
Failed to locate resource named "default.csv"
CAMetalLayer ignoring invalid setDrawableSize width=0.000000 height=0.000000
ğŸ” updateUIView called: overlaysLoaded=false, userPermitAreas=["I"], lastUserPermitAreas=[]
ğŸ” Updating coordinator userPermitAreas: [] -> ["I"]
ğŸ“ User coordinate changed - recentering map to (37.759000, -122.423500)
ğŸ¬ Initial overlay load: 421 zones (overlaysLoaded=false)
ğŸ”§ loadOverlays called with shouldShowOverlays=false
ğŸ”§ loadOverlays: initialized lastUserPermitAreas=["I"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=0, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=1, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=2, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=3, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=4, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=5, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=6, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=7, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=BB, boundaryIndex=8, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=C, boundaryIndex=6, validAreas=["C", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=F, boundaryIndex=6, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=F, boundaryIndex=7, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=F, boundaryIndex=8, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=G, boundaryIndex=14, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=G, boundaryIndex=15, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=G, boundaryIndex=16, validAreas=["F", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=G, boundaryIndex=29, validAreas=["C", "G"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=12, validAreas=["HV", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=13, validAreas=["HV", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=14, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=15, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=16, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=17, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=18, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=19, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=20, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=21, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=22, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=23, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=24, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=HV, boundaryIndex=25, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=46, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=47, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=48, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=49, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=50, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=51, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=52, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=53, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=54, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=I, boundaryIndex=55, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=26, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=27, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=28, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=29, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=30, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=31, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=32, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=33, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=L, boundaryIndex=34, validAreas=["BB", "L"]
  ğŸ¯ Multi-permit boundary matched: zone=P, boundaryIndex=10, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=P, boundaryIndex=11, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=P, boundaryIndex=12, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=P, boundaryIndex=13, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=13, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=14, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=15, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=16, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=17, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=18, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=19, validAreas=["HV", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=20, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=21, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=22, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=23, validAreas=["P", "Q"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=24, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=25, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=26, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=27, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=28, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=29, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=30, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=31, validAreas=["Q", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=Q, boundaryIndex=32, validAreas=["Q", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=R, boundaryIndex=14, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=R, boundaryIndex=15, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=R, boundaryIndex=16, validAreas=["HV", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=R, boundaryIndex=17, validAreas=["Q", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=R, boundaryIndex=18, validAreas=["Q", "R"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=0, validAreas=["HV", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=1, validAreas=["HV", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=63, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=64, validAreas=["HV", "Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=65, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=66, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=67, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=68, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=69, validAreas=["Q", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=70, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=71, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=72, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=73, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=74, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=75, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=76, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=77, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=78, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=S, boundaryIndex=79, validAreas=["I", "S"]
  ğŸ¯ Multi-permit boundary matched: zone=W, boundaryIndex=26, validAreas=["W", "X"]
  ğŸ¯ Multi-permit boundary matched: zone=X, boundaryIndex=17, validAreas=["W", "X"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=34, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=35, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=36, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=37, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=38, validAreas=["S", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=39, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=40, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=41, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=42, validAreas=["I", "Z"]
  ğŸ¯ Multi-permit boundary matched: zone=Z, boundaryIndex=43, validAreas=["I", "Z"]
ğŸš§ PoC: Hiding zone overlays (blockface mode active)
ğŸš§ PoC: Initial load with blockface overlays enabled - zooming to Mission/Valencia 22nd-25th sample area
Loading blockfaces from sample JSON
Loaded 15 blockfaces
ğŸš§ PoC: Loaded 15 blockfaces
ğŸ”§ DEBUG: Adding 15 blockface overlays
ğŸ”§ DEBUG: Blockface 0 (Mission St, EVEN side)
  Centerline points: 4
  First point: lat=37.7564, lon=-122.4193
  Second point: lat=37.757, lon=-122.4191
  Direction: dlat=0.0005999999999986017, dlon=0.0002000000000066393
ğŸ”§ DEBUG: Perpendicular calculation for EVEN side (offsetToRight=true)
  Forward vector: dlat=0.0005999999999986017, dlon=0.0002000000000066393
  Perp vector: dlat=-0.0002000000000066393, dlon=0.0005999999999986017
  Point 0: centerline=(37.7564, -122.4193), offset=(37.75638893202819, -122.41926679608457)
    Offset applied: dlat=-1.106797181094322e-05, dlon=3.320391543165002e-05
  Point 1: centerline=(37.757, -122.4191), offset=(37.756988932028186, -122.41906679608456)
    Offset applied: dlat=-1.106797181094322e-05, dlon=3.320391543165002e-05
  ğŸ”· POLYGON VERTICES (8 total):
    Centerline points (4):
      [0] lat=37.7564, lon=-122.4193
      [1] lat=37.757, lon=-122.4191
      [2] lat=37.7576, lon=-122.4189
      [3] lat=37.7582, lon=-122.4187
    Offset points (4, reversed in polygon):
      [0] lat=37.75638893202819, lon=-122.41926679608457
      [1] lat=37.756988932028186, lon=-122.41906679608456
      [2] lat=37.757588932028185, lon=-122.41886679608456
      [3] lat=37.75818893202819, lon=-122.41866679608457
    Final polygon order:
      [0] lat=37.7564, lon=-122.4193
      [1] lat=37.757, lon=-122.4191
      [2] lat=37.7576, lon=-122.4189
      [3] lat=37.7582, lon=-122.4187
      [4] lat=37.75818893202819, lon=-122.41866679608457
      [5] lat=37.757588932028185, lon=-122.41886679608456
      [6] lat=37.756988932028186, lon=-122.41906679608456
      [7] lat=37.75638893202819, lon=-122.41926679608457
  Created polygon with 8 points
  Width setting: 3.5000000000000004e-05 degrees
ğŸ”§ DEBUG: Blockface 1 (Mission St, ODD side)
  Centerline points: 4
  First point: lat=37.7565, lon=-122.4189
  Second point: lat=37.7571, lon=-122.4187
  Direction: dlat=0.0005999999999986017, dlon=0.00019999999999242846
ğŸ”§ DEBUG: Perpendicular calculation for ODD side (offsetToRight=false)
  Forward vector: dlat=0.0005999999999986017, dlon=0.00019999999999242846
  Perp vector: dlat=0.00019999999999242846, dlon=-0.0005999999999986017
  Point 0: centerline=(37.7565, -122.4189), offset=(37.756511067971815, -122.41893320391543)
    Offset applied: dlat=1.1067971810235438e-05, dlon=-3.3203915431885955e-05
  Point 1: centerline=(37.7571, -122.4187), offset=(37.75711106797181, -122.41873320391544)
    Offset applied: dlat=1.106797181058933e-05, dlon=-3.320391543176799e-05
  ğŸ”· POLYGON VERTICES (8 total):
    Centerline points (4):
      [0] lat=37.7565, lon=-122.4189
      [1] lat=37.7571, lon=-122.4187
      [2] lat=37.7577, lon=-122.4185
      [3] lat=37.7583, lon=-122.4183
    Offset points (4, reversed in polygon):
      [0] lat=37.756511067971815, lon=-122.41893320391543
      [1] lat=37.75711106797181, lon=-122.41873320391544
      [2] lat=37.75771106797181, lon=-122.41853320391543
      [3] lat=37.75831106797181, lon=-122.41833320391544
    Final polygon order:
      [0] lat=37.7565, lon=-122.4189
      [1] lat=37.7571, lon=-122.4187
      [2] lat=37.7577, lon=-122.4185
      [3] lat=37.7583, lon=-122.4183
      [4] lat=37.75831106797181, lon=-122.41833320391544
      [5] lat=37.75771106797181, lon=-122.41853320391543
      [6] lat=37.75711106797181, lon=-122.41873320391544
      [7] lat=37.756511067971815, lon=-122.41893320391543
  Created polygon with 8 points
  Width setting: 3.5000000000000004e-05 degrees
ğŸ”§ DEBUG: Blockface 2 (Mission St, EVEN side)
  Centerline points: 4
  First point: lat=37.7582, lon=-122.4187
  Second point: lat=37.7588, lon=-122.4185
  Direction: dlat=0.0005999999999986017, dlon=0.0002000000000066393
  Created polygon with 8 points
  Width setting: 3.5000000000000004e-05 degrees
ğŸ”§ DEBUG: Perpendicular calculation for ODD side (offsetToRight=false)
  Forward vector: dlat=0.0005999999999986017, dlon=0.00019999999999242846
  Perp vector: dlat=0.00019999999999242846, dlon=-0.0005999999999986017
  Point 0: centerline=(37.7565, -122.4203), offset=(37.756511067971815, -122.42033320391543)
    Offset applied: dlat=1.1067971810235438e-05, dlon=-3.3203915431885955e-05
  Point 1: centerline=(37.7571, -122.4201), offset=(37.75711106797181, -122.42013320391544)
    Offset applied: dlat=1.106797181058933e-05, dlon=-3.320391543176799e-05
  ğŸ”· POLYGON VERTICES (8 total):
    Centerline points (4):
      [0] lat=37.7565, lon=-122.4203
      [1] lat=37.7571, lon=-122.4201
      [2] lat=37.7577, lon=-122.4199
      [3] lat=37.7583, lon=-122.4197
    Offset points (4, reversed in polygon):
      [0] lat=37.756511067971815, lon=-122.42033320391543
      [1] lat=37.75711106797181, lon=-122.42013320391544
      [2] lat=37.75771106797181, lon=-122.41993320391543
      [3] lat=37.75831106797181, lon=-122.41973320391544
    Final polygon order:
      [0] lat=37.7565, lon=-122.4203
      [1] lat=37.7571, lon=-122.4201
      [2] lat=37.7577, lon=-122.4199
      [3] lat=37.7583, lon=-122.4197
      [4] lat=37.75831106797181, lon=-122.41973320391544
      [5] lat=37.75771106797181, lon=-122.41993320391543
      [6] lat=37.75711106797181, lon=-122.42013320391544
      [7] lat=37.756511067971815, lon=-122.42033320391543
âœ… PoC: Added blockface overlays to map
ğŸ”§ DEBUG: MainResultView body - devMode: true, expanded: true, panel: false
ğŸ” updateUIView called: overlaysLoaded=true, userPermitAreas=["I"], lastUserPermitAreas=["I"]
âœ“ Overlay parameters updated (no reload needed)
ğŸ” Visibility check: showOverlays=false, overlaysVisible=false, overlays.count=15